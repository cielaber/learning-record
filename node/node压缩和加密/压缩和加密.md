# 压缩和加密

### 压缩

#### 压缩与解压处理

node中可以使用 `zlib`模块进行压缩及解压缩处理，压缩文件以后减少体积，加快传输速度和节约带宽。

#### 压缩对象

`zlib`压缩和解压缩对象都是一个可读可写流。

| 方法               | 说明                                                     |
| ------------------ | -------------------------------------------------------- |
| zlib.createGzip    | 返回Gzip流对象，使用Gzip算法对数据进行压缩处理。         |
| zlib.createGunzip  | 返回Gzip流对象，使用Gzip算法对压缩的数据进行解压缩处理。 |
| zlib.createDeflate | 返回Deflate流对象，使用Deflate算法对数据进行压缩处理。   |
| zlib.createInflate | 返回Deflate流对象，使用Deflate算法对数据进行解压缩处理。 |

### 加密

#### crypto

`crypto`是node.js中实现加密和解密的模块，在node.js中，使用 `OpenSSL`类库作为内部实现加密解密的手段，`OpenSSL`是一个经过严格测试的可靠的加密和解密算法的实现工具。

#### 散列(哈希)算法

散列算法也叫哈希算法，用来把任意长度的输入变换成固定长度的输出，常见的有md5、sha1等。

- 相同的输入会产生相同的输出
- 不同的输入会产生不同的输出
- 任意的输入长度输出长度是相同的
- 不能从输出推算出输入的值

缺点：

- 算法公开，能被反向破解。

#### HMAC算法

HMAC算法将散列算法与一个密钥结合在一起，以阻止对签名完整性的破坏。

##### 语法

```js
let hamc = crypto.createHamc(algorithm, key);
hamc.update(data);
hmac.digest('hex');
```

- algorithm是一个可用的摘要算法，例如：sha1、md5、sha256
- key为一个字符串，用于指定一个PEM格式的密钥。

##### 生成私钥

PEM是OpenSSL的标准格式，OpenSSL使用PEM文件格式存储证书和密钥，是基于Base64编码的证书。

```bash
openssl genrsa -out rsa_private.key 1024
```

> 严格来说，以上两种都属于生成摘要。加密对应的有解密，但摘要一般不解密，只是用来隐藏元数据并作为其唯一标识。

#### 对称加密

对称的意思就是加密和解密使用的是同一个密钥。

缺点：密钥传输不安全
